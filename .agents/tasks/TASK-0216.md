# TASK-0216: Post-call reconcile runner (admin, out-of-band)

Status: DONE  
Assigned: Codex Agent A  
Date: 2026-02-19 (America/New_York)

## Objective
Add an admin endpoint that scans recent completed calls and backfills missing post-call extraction outputs without touching Flow A hot path.

## Endpoint
- `POST /admin/postcall/reconcile`
- Auth: `Authorization: Bearer <VOZ_ADMIN_API_KEY>`
- Body (strict JSON):
  - `tenant_id: str`
  - `since_ts: int = 0`
  - `limit: int = 50` (hard cap `<= 200`)
  - `dry_run: bool = false`

## Required controls
- `VOZ_FEATURE_POSTCALL_RECONCILE=0|1` (feature gate)
- `VOZ_POSTCALL_RECONCILE_ENABLED=0|1` (runtime gate)
- `VOZ_SELF_BASE_URL` (default `http://127.0.0.1:${PORT}`)
- `VOZ_POSTCALL_RECONCILE_TIMEOUT_MS` (default `3000`)

## Behavior
- Query tenant-scoped `flow_a.call_stopped` rows by `(tenant_id, since_ts, limit)`.
- For each `rid`:
  - skip if `postcall.summary` already exists
  - read `ai_mode` from `flow_a.call_stopped.payload.ai_mode`
  - call internal `POST /admin/postcall/extract` with idempotency key `reconcile-{rid}-v1`
- Continue batch on per-rid failure; return attempted/created/skipped/errors counts.
- Debug-only signatures:
  - `POSTCALL_RECONCILE_START ...`
  - `POSTCALL_RECONCILE_DONE attempted=... created=... skipped=... errors=...`

## Acceptance coverage
- Missing/invalid auth -> `401`
- Missing summaries are created through reconcile path
- Existing summaries are skipped (no duplicate outputs)
- Tenant isolation enforced
